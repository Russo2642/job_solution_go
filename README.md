# JobSolution - Платформа отзывов сотрудников о компаниях

Backend API приложения для платформы отзывов сотрудников о компаниях, реализованный на Go с использованием PostgreSQL.

## Основные функции

- Регистрация и авторизация пользователей
- Управление профилями пользователей
- Создание и просмотр компаний
- Добавление и модерация отзывов о компаниях
- Автоматический расчет общего рейтинга компаний на основе категорий оценки
- Рейтинги компаний по разным категориям
- Система модерации контента

## Технологии

- **Backend**: Go, Gin
- **База данных**: PostgreSQL
- **Аутентификация**: JWT
- **Документация**: Swagger

## Система рейтингов

В приложении реализована улучшенная система рейтингов со следующими особенностями:

- Пользователи оценивают компанию по различным категориям (например, зарплата, условия труда, руководство и т.д.)
- Общий рейтинг отзыва рассчитывается автоматически как среднее значение рейтингов по всем категориям
- При публикации новых отзывов или изменении их статуса автоматически пересчитывается общий рейтинг компании
- Рейтинг компании также включает средние оценки по каждой из категорий
- Система позволяет фильтровать компании и отзывы по рейтингам

Это обеспечивает более точную и объективную оценку компаний на основе мнения сотрудников.

## Структура проекта

```
job_solition/
├── cmd/                # Точки входа в приложение
│   └── api/            # HTTP API сервер
├── internal/           # Внутренние пакеты приложения
│   ├── config/         # Конфигурация приложения
│   ├── db/             # Работа с базой данных
│   │   └── migrations/ # SQL миграции
│   ├── handlers/       # HTTP обработчики
│   ├── middleware/     # Middleware компоненты
│   ├── models/         # Модели данных
│   ├── repository/     # Репозитории для работы с данными
│   ├── routes/         # Маршруты API
│   ├── server/         # Настройка HTTP сервера
│   ├── service/        # Бизнес-логика приложения
│   └── utils/          # Вспомогательные утилиты
└── docs/               # Документация API (Swagger)
```

## Запуск проекта

### Предварительные требования

- Go 1.21 или выше
- PostgreSQL 14 или выше
- Docker (опционально)

### Настройка базы данных

#### С использованием Docker:

```bash
# Запустить PostgreSQL в Docker
make postgres-start

# Остановить PostgreSQL
make postgres-stop
```

#### Ручная настройка:

1. Установите PostgreSQL на вашей системе
2. Создайте базу данных:
```sql
CREATE DATABASE jobsolution;
```

### Настройка переменных окружения

Создайте файл `.env` в корне проекта со следующими параметрами:

```
# Сервер
SERVER_PORT=8080
SERVER_MODE=debug

# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=jobsolution
POSTGRES_SSLMODE=disable
POSTGRES_MAX_OPEN_CONNS=25
POSTGRES_MAX_IDLE_CONNS=25
POSTGRES_CONN_MAX_LIFETIME=5m

# JWT
JWT_SECRET=your_secret_key
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=168h

# Безопасность
PASSWORD_SALT=your_password_salt

# Лимиты запросов
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_DURATION=1m
```

### Сборка и запуск

```bash
# Установка зависимостей
go mod tidy

# Генерация Swagger документации
make swagger

# Запуск приложения
make run

# Сборка приложения
make build

# Запуск из бинарного файла
./bin/job_solition
```

## API документация

После запуска приложения, Swagger документация доступна по адресу:
```
http://localhost:8080/swagger/index.html
```

## Основные API эндпоинты

### Авторизация
- `POST /api/v1/auth/register` - Регистрация нового пользователя
- `POST /api/v1/auth/login` - Вход в систему
- `POST /api/v1/auth/refresh` - Обновление токена доступа
- `POST /api/v1/auth/logout` - Выход из системы

### Пользователи
- `GET /api/v1/users/profile` - Получение профиля пользователя
- `PUT /api/v1/users/profile` - Обновление профиля пользователя
- `DELETE /api/v1/users/profile` - Удаление профиля пользователя

### Компании
- `POST /api/v1/companies` - Создание новой компании
- `GET /api/v1/companies` - Получение списка компаний
- `GET /api/v1/companies/:id` - Получение информации о компании
- `PUT /api/v1/companies/:id` - Обновление компании
- `DELETE /api/v1/companies/:id` - Удаление компании

### Отзывы
- `POST /api/v1/reviews` - Создание нового отзыва
- `GET /api/v1/reviews/company/:id` - Получение отзывов о компании
- `GET /api/v1/reviews/user` - Получение отзывов пользователя
- `GET /api/v1/reviews/:id` - Получение информации об отзыве
- `PUT /api/v1/reviews/:id` - Обновление отзыва
- `DELETE /api/v1/reviews/:id` - Удаление отзыва

### Модерация
- `GET /api/v1/moderation/reviews` - Получение отзывов на модерацию
- `PUT /api/v1/moderation/reviews/:id` - Модерация отзыва 